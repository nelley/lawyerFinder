<!-- lawyer_home = 
        _consulting + _service
-->
<!DOCTYPE html>
{% load staticfiles %}
{% load bootstrap3 %}
{% load i18n %}
{% load getArea %}
{% load getField %}

<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>好律師你在哪裡</title>

    <!-- Bootstrap Core CSS -->
    <link href="{% static "lawyerFinder/css/bootstrap.css" %}" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="{% static "lawyerFinder/css/modern-business.css" %}" rel="stylesheet">
    <link href="{% static "lawyerFinder/css/slider.css" %}" rel="stylesheet">
    <link href="{% static "lawyerFinder/css/lawyer_service.css" %}" rel="stylesheet">
    
    
    <!-- Custom Fonts -->
    <link href="{% static "lawyerFinder/css/font-awesome.min.css" %}" rel="stylesheet">
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.css" rel="stylesheet">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="{% static "lawyerFinder/js/hammer.js" %}"></script>

</head>

<body>

{% include "common/header.html" %}

    <!-- Page Content -->
    <div class="container">

        <!-- Page Heading/Breadcrumbs -->
        <div class="row">
            <div class="col-lg-12">
                <h2 class="page-header">基本資料
                    <small>上班時間8:00-18:00</small>
                </h2>
            </div>
        </div>
        <!-- /.row -->

        <!-- Image Header -->
        {% for law in law_selected%}
        <div class="row">
            <div class="row">
                <div class="col-sm-12">
                    <div class="col-xs-12 col-sm-3 text-center">
                        <figure>
                            <h2><img src="http://placehold.it/150x150" alt="" class="img-rounded img-responsive"></h2>
                        </figure>
                    </div>
                    <div class="col-xs-12 col-sm-9">
                        <h2><a href="/lawyerHome/{{ law.lawyerNo }}">{{ law.user.first_name }}</a></h2>
                        <figcaption class="ratings">
                                <p>Ratings
                                <a href="#">
                                    <span class="fa fa-star"></span>
                                </a>
                                <a href="#">
                                    <span class="fa fa-star"></span>
                                </a>
                                <a href="#">
                                    <span class="fa fa-star"></span>
                                </a>
                                <a href="#">
                                    <span class="fa fa-star"></span>
                                </a>
                                <a href="#">
                                     <span class="fa fa-star-o"></span>
                                </a> 
                                </p>
                        </figcaption>
                        <p><strong>執業年數: </strong>{{ law.careerYear }}</p>
                        <p><strong>執業地區: </strong>{{ law|get_area }}</p>
                        <p><strong>擅長領域: </strong>
                            {% for field in law|get_field %}
                                <span class="tags">{{ field.litigations.category_cn }}</span>
                            {% endfor %}
                        </p>
                    </div>
                </div>
        </div>
        {% endfor %}
        <!-- /.row -->
        
        {% include "lawyerFinder/_consulting.html" %}
        {% include "lawyerFinder/_service.html" %}
        <hr>
        
        <!-- Footer -->
        <footer>
            <div class="row">
                <div class="col-lg-12">
                    <p>Copyright &copy; Your Website 2014</p>
                </div>
            </div>
        </footer>
    </div>
    <!-- /.container -->

    <script src="{% static "lawyerFinder/js/jquery.js" %}"></script>
    <script src="{% static "lawyerFinder/js/bootstrap.js" %}"></script>
    <!-- js for consulting block-->
    <script>
      $(function() {
          var myElement = document.getElementById('CarouselDown');
          var mc = new Hammer(myElement);
          // listen to events
          mc.on("panleft", function(ev) {
              $('.carousel').carousel('next');
          });
          mc.on("panright", function(ev) {
              $('.carousel').carousel('prev');
          })
      });
      
      $('.carousel').carousel({
        interval: 0 //changes the speed
      })
      
    </script>
    
    <!-- js for service block-->
    <script>
      $(function() {
        // init heights of 5 elements
        var s_one = $('#ser-0').outerHeight();
        var s_two = $('#ser-1').outerHeight();
        var s_three = $('#ser-2').outerHeight();
        var s_four = $('#ser-3').outerHeight();
        var s_five = $('#ser-4').outerHeight();
        
        var heightArr = [s_one, s_two, s_three, s_four, s_five];
        
        $('.elastic-row').each(function(i){
            $(this).animate({
                height: "0px"
            }, 1500, function() {
                //alert($(this).attr('id'));
                $('#a-' + i).removeClass('expanding');
            });
        });
        
        // select by tag with id in a-*
        $("a[id*='a-']").click(function(){
            var element = $(this).parent().next();
            var num = element.attr('id').split("-")[1];

            if(element.hasClass('active')) {// expanded
            
              element.removeClass('active');
            
              $(element).animate({
                  height: "0px"
              }, 1000, function() {
                  $('#a-' + num).removeClass('expanding');
              });
            
            } else {//folded
              $(this).addClass('expanding');
              element.addClass('active');
            
              $(element).animate({
                  height: heightArr[num]
              }, 1000, function() {/*do something after anim*/});
          }
        });
      });
      
    </script>
    
    <!-- js for getting ckeditor with modal -->
    <script>
        $("button[id*='c-']").on('click', function () {
            // change to s-1
            var clickedE= $(this).attr('id')
            var titleId = clickedE.replace('c' , 's');
            var title = document.getElementById(titleId).textContent;
            $('.modal-title').text(title);
            
            $('input[name=editType]').attr('value', clickedE.split('-')[1]);
            
            var textDisplay = $(this).parent().children().html();
            
            // init ckeditor's notent(id_basic is the id of textarea)
            CKEDITOR.instances.id_basic.setData( textDisplay, function(){
                this.checkDirty();  // true
            });
            
        });
        
        var url = '{% url 'lawyer_home' '01' %}';
        
        $("#editCommit").on('click', function(){
            $.ajaxSetup({ 
                beforeSend: function(xhr, settings) {
                    function getCookie(name) {
                        var cookieValue = null;
                        if (document.cookie && document.cookie != '') {
                            var cookies = document.cookie.split(';');
                            for (var i = 0; i < cookies.length; i++) {
                                var cookie = jQuery.trim(cookies[i]);
                                // Does this cookie string begin with the name we want?
                                if (cookie.substring(0, name.length + 1) == (name + '=')) {
                                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                                    break;
                                }
                            }
                        }
                        return cookieValue;
                    }
                    function updateCKEditor(){
                        for (instance in CKEDITOR.instances) {
                            CKEDITOR.instances[instance].updateElement();
                        }
                    }
                    
                    xhr.setRequestHeader("X-CSRFToken", getCookie('csrftoken'));
                    updateCKEditor();
                }
            });
            
            
            $.ajax({
                type: 'POST',
                url: url,
                data: {type:$('input[name=editType]').val(),
                       basic:CKEDITOR.instances.id_basic.getData()
                      },
                success: function(data, textStatus, jqXHR) {
                    $('#m-body').append('<div id="fadeOut" class="alert alert-' + data.result+ '">' + data.message + '</div>');
                    $('#service-'+ data.type + ' .service-content').html(data.contents);
                    setTimeout(function(){
                        $('#fadeOut').fadeOut("slow", function(){
                            $('#fadeOut').remove();
                        });
                    }, 1000);
                },
                error:function(jqXHR, textStatus, errorThrown) {
                    alert(errorThrown);
                }
            });
        });
        
    </script>
    
</body>

</html>
